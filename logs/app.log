{"timestamp": "2025-02-08T17:06:49.425775", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:06:49.426645", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:08:25.373111", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:08:25.374071", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:11:39.962633", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:11:39.963733", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:12:12.791003", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:12:12.797326", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:19:14.226313", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:19:14.227326", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:19:14.250478", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:19:14.796496", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 172}
{"timestamp": "2025-02-08T17:19:14.830779", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 251, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 218, in _scan_iam\n    request = resourcemanager_v3.GetIamPolicyRequest(resource=project_name)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: module 'google.cloud.resourcemanager_v3' has no attribute 'GetIamPolicyRequest'\n"}
{"timestamp": "2025-02-08T17:19:14.902220", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 76}
{"timestamp": "2025-02-08T17:19:14.903677", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 85}
{"timestamp": "2025-02-08T17:19:14.904265", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:19:14.909082", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 136}
{"timestamp": "2025-02-08T17:19:14.919174", "level": "ERROR", "logger": "src.modules.reporter", "message": "Failed to generate report: 'Finding' object has no attribute 'get'", "module": "reporter", "function": "generate_report", "line": 175}
{"timestamp": "2025-02-08T17:19:14.930691", "level": "ERROR", "logger": "__main__", "message": "Error in main execution: 'Finding' object has no attribute 'get'", "module": "main", "function": "run", "line": 87, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/main.py\", line 72, in run\n    report = self.reporter.generate_report(findings)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/reporter.py\", line 143, in generate_report\n    detailed_finding = self._create_detailed_finding(finding)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/reporter.py\", line 80, in _create_detailed_finding\n    cis_id = finding.get(\"cis_id\")\n             ^^^^^^^^^^^\nAttributeError: 'Finding' object has no attribute 'get'\n"}
{"timestamp": "2025-02-08T17:21:10.742507", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:21:10.743505", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:21:10.769304", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:21:11.332987", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:21:12.599139", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:21:12.600548", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:21:12.600654", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:21:12.600907", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:21:12.600972", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 96}
{"timestamp": "2025-02-08T17:21:12.601033", "level": "ERROR", "logger": "src.modules.reporter", "message": "Failed to generate report: 'project_id'", "module": "reporter", "function": "generate_report", "line": 139}
{"timestamp": "2025-02-08T17:21:12.601488", "level": "ERROR", "logger": "__main__", "message": "Error in main execution: 'project_id'", "module": "main", "function": "run", "line": 87, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/main.py\", line 72, in run\n    report = self.reporter.generate_report(findings)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/reporter.py\", line 122, in generate_report\n    \"project_id\": self.config['gcp']['project_id'],\n                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\nKeyError: 'project_id'\n"}
{"timestamp": "2025-02-08T17:21:34.947934", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:21:34.955351", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:21:34.990153", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:21:36.071281", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:21:37.372114", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:21:37.375072", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:21:37.375357", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:21:37.376031", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:21:37.376261", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 96}
{"timestamp": "2025-02-08T17:21:37.377705", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully", "module": "reporter", "function": "_save_csv_report", "line": 85}
{"timestamp": "2025-02-08T17:21:37.377773", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 135}
{"timestamp": "2025-02-08T17:21:37.377908", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:21:37.378933", "level": "ERROR", "logger": "src.modules.notifier", "message": "Error sending notifications", "module": "notifier", "function": "send_notifications", "line": 289, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 274, in send_notifications\n    slack_message = NotificationTemplate.generate_slack_message(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 134, in generate_slack_message\n    if f.risk_level.lower() in [\"critical\", \"high\"]\n       ^^^^^^^^^^^^\nAttributeError: 'dict' object has no attribute 'risk_level'\n"}
{"timestamp": "2025-02-08T17:21:37.380764", "level": "ERROR", "logger": "__main__", "message": "Error in main execution: 'dict' object has no attribute 'risk_level'", "module": "main", "function": "run", "line": 87, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/main.py\", line 78, in run\n    await self.notifier.send_notifications(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 274, in send_notifications\n    slack_message = NotificationTemplate.generate_slack_message(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 134, in generate_slack_message\n    if f.risk_level.lower() in [\"critical\", \"high\"]\n       ^^^^^^^^^^^^\nAttributeError: 'dict' object has no attribute 'risk_level'\n"}
{"timestamp": "2025-02-08T17:22:22.427447", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:22:22.428343", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:22:22.445674", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:22:23.074019", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:22:24.266484", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:22:24.267720", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:22:24.267813", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:22:24.268030", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:22:24.268094", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 96}
{"timestamp": "2025-02-08T17:22:24.268537", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully", "module": "reporter", "function": "_save_csv_report", "line": 85}
{"timestamp": "2025-02-08T17:22:24.268601", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 135}
{"timestamp": "2025-02-08T17:22:24.268637", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:22:24.268718", "level": "INFO", "logger": "src.modules.notifier", "message": "No notification channels enabled", "module": "notifier", "function": "send_notifications", "line": 233}
{"timestamp": "2025-02-08T17:22:24.268765", "level": "INFO", "logger": "__main__", "message": "Notifications sent successfully", "module": "main", "function": "run", "line": 79}
{"timestamp": "2025-02-08T17:22:24.268798", "level": "INFO", "logger": "__main__", "message": "Cloud Security Auditor completed successfully", "module": "main", "function": "run", "line": 82}
{"timestamp": "2025-02-08T17:23:27.416994", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:23:27.418509", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:23:27.441280", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:23:27.904336", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:23:29.006611", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:23:29.009278", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:23:29.009459", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:23:29.009833", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:23:29.009956", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 69}
{"timestamp": "2025-02-08T17:23:29.010633", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully", "module": "reporter", "function": "_save_csv_report", "line": 58}
{"timestamp": "2025-02-08T17:23:29.010708", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 120}
{"timestamp": "2025-02-08T17:23:29.010758", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:23:29.011611", "level": "ERROR", "logger": "src.modules.notifier", "message": "Error sending notifications", "module": "notifier", "function": "send_notifications", "line": 236, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 217, in send_notifications\n    email_body = NotificationTemplate.generate_email_body(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 64, in generate_email_body\n    Remediation: {finding[\"remediation_steps\"]}\n                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'remediation_steps'\n"}
{"timestamp": "2025-02-08T17:23:29.012176", "level": "ERROR", "logger": "__main__", "message": "Error in main execution: 'remediation_steps'", "module": "main", "function": "run", "line": 87, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/main.py\", line 78, in run\n    await self.notifier.send_notifications(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 217, in send_notifications\n    email_body = NotificationTemplate.generate_email_body(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 64, in generate_email_body\n    Remediation: {finding[\"remediation_steps\"]}\n                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'remediation_steps'\n"}
{"timestamp": "2025-02-08T17:24:16.140989", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:24:16.142165", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:24:16.163885", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:24:16.641067", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:24:17.626192", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:24:17.628786", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:24:17.628943", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:24:17.629321", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:24:17.629489", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 69}
{"timestamp": "2025-02-08T17:24:17.630106", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully", "module": "reporter", "function": "_save_csv_report", "line": 58}
{"timestamp": "2025-02-08T17:24:17.630193", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 120}
{"timestamp": "2025-02-08T17:24:17.630258", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:24:17.630379", "level": "INFO", "logger": "src.modules.notifier", "message": "No notification channels enabled", "module": "notifier", "function": "send_notifications", "line": 236}
{"timestamp": "2025-02-08T17:24:17.630447", "level": "INFO", "logger": "__main__", "message": "Notifications sent successfully", "module": "main", "function": "run", "line": 79}
{"timestamp": "2025-02-08T17:24:17.630507", "level": "INFO", "logger": "__main__", "message": "Cloud Security Auditor completed successfully", "module": "main", "function": "run", "line": 82}
{"timestamp": "2025-02-08T17:25:29.079632", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:25:29.080487", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:25:29.100590", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:25:29.602162", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:25:30.705784", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:25:30.708046", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:25:30.708198", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:25:30.708546", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:25:30.708658", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 70}
{"timestamp": "2025-02-08T17:25:30.709202", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully", "module": "reporter", "function": "_save_csv_report", "line": 59}
{"timestamp": "2025-02-08T17:25:30.709269", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 121}
{"timestamp": "2025-02-08T17:25:30.709333", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:25:30.709429", "level": "INFO", "logger": "src.modules.notifier", "message": "No notification channels enabled", "module": "notifier", "function": "send_notifications", "line": 236}
{"timestamp": "2025-02-08T17:25:30.709483", "level": "INFO", "logger": "__main__", "message": "Notifications sent successfully", "module": "main", "function": "run", "line": 79}
{"timestamp": "2025-02-08T17:25:30.709530", "level": "INFO", "logger": "__main__", "message": "Cloud Security Auditor completed successfully", "module": "main", "function": "run", "line": 82}
{"timestamp": "2025-02-08T17:26:11.961935", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:26:11.962869", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:26:11.988767", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:26:12.447729", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:26:13.544333", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:26:13.546538", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:26:13.546732", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:26:13.547125", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:26:13.547265", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 71}
{"timestamp": "2025-02-08T17:26:13.547937", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_172613.csv", "module": "reporter", "function": "_save_csv_report", "line": 60}
{"timestamp": "2025-02-08T17:26:13.548028", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 122}
{"timestamp": "2025-02-08T17:26:13.548092", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:26:13.548210", "level": "INFO", "logger": "src.modules.notifier", "message": "No notification channels enabled", "module": "notifier", "function": "send_notifications", "line": 236}
{"timestamp": "2025-02-08T17:26:13.548277", "level": "INFO", "logger": "__main__", "message": "Notifications sent successfully", "module": "main", "function": "run", "line": 79}
{"timestamp": "2025-02-08T17:26:13.548336", "level": "INFO", "logger": "__main__", "message": "Cloud Security Auditor completed successfully", "module": "main", "function": "run", "line": 82}
{"timestamp": "2025-02-08T17:28:18.093314", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:28:18.094288", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:28:18.116265", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:28:18.573601", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:28:19.632806", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:28:19.635861", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:28:19.636019", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:28:19.636387", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:28:19.636536", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 121}
{"timestamp": "2025-02-08T17:28:19.637111", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_172819.csv", "module": "reporter", "function": "_save_csv_report", "line": 110}
{"timestamp": "2025-02-08T17:28:19.637201", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 175}
{"timestamp": "2025-02-08T17:28:19.637259", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:28:19.637361", "level": "INFO", "logger": "src.modules.notifier", "message": "No notification channels enabled", "module": "notifier", "function": "send_notifications", "line": 236}
{"timestamp": "2025-02-08T17:28:19.637459", "level": "INFO", "logger": "__main__", "message": "Notifications sent successfully", "module": "main", "function": "run", "line": 79}
{"timestamp": "2025-02-08T17:28:19.637524", "level": "INFO", "logger": "__main__", "message": "Cloud Security Auditor completed successfully", "module": "main", "function": "run", "line": 82}
{"timestamp": "2025-02-08T17:28:57.435195", "level": "INFO", "logger": "__main__", "message": "Logging initialized successfully", "module": "main", "function": "_setup_logging", "line": 36}
{"timestamp": "2025-02-08T17:28:57.436255", "level": "INFO", "logger": "__main__", "message": "GCP credentials initialized successfully", "module": "main", "function": "_setup_credentials", "line": 52}
{"timestamp": "2025-02-08T17:28:57.455968", "level": "INFO", "logger": "__main__", "message": "Starting Cloud Security Auditor", "module": "main", "function": "run", "line": 62}
{"timestamp": "2025-02-08T17:28:57.967574", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning batch of 1 storage buckets", "module": "scanner", "function": "_scan_storage", "line": 173}
{"timestamp": "2025-02-08T17:28:59.022876", "level": "ERROR", "logger": "src.modules.scanner", "message": "Error in IAM scanning", "module": "scanner", "function": "_scan_iam", "line": 252, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py\", line 220, in _scan_iam\n    policy = self.resource_manager_client.get_iam_policy(request=request)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py\", line 1927, in get_iam_policy\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target\n    _retry_error_helper(\n    ~~~~~~~~~~~~~~~~~~~^\n        exc,\n        ^^^^\n    ...<6 lines>...\n        timeout,\n        ^^^^^^^^\n    )\n    ^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target\n    result = target()\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: \"SERVICE_DISABLED\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"cloudresourcemanager.googleapis.com\"\n}\nmetadata {\n  key: \"serviceTitle\"\n  value: \"Cloud Resource Manager API\"\n}\nmetadata {\n  key: \"containerInfo\"\n  value: \"379849595138\"\n}\nmetadata {\n  key: \"consumer\"\n  value: \"projects/379849595138\"\n}\nmetadata {\n  key: \"activationUrl\"\n  value: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n, locale: \"en-US\"\nmessage: \"Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"\n, links {\n  description: \"Google developers console API activation\"\n  url: \"https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138\"\n}\n]\n"}
{"timestamp": "2025-02-08T17:28:59.025295", "level": "INFO", "logger": "src.modules.scanner", "message": "Scanning bucket: misconfigured_public_bucket", "module": "scanner", "function": "_scan_storage_bucket", "line": 77}
{"timestamp": "2025-02-08T17:28:59.025492", "level": "WARNING", "logger": "src.modules.scanner", "message": "Bucket misconfigured_public_bucket is publicly accessible", "module": "scanner", "function": "_scan_storage_bucket", "line": 86}
{"timestamp": "2025-02-08T17:28:59.025918", "level": "INFO", "logger": "__main__", "message": "Scanning completed. Found 1 findings.", "module": "main", "function": "run", "line": 67}
{"timestamp": "2025-02-08T17:28:59.026101", "level": "INFO", "logger": "src.modules.reporter", "message": "Generating security audit report", "module": "reporter", "function": "generate_report", "line": 121}
{"timestamp": "2025-02-08T17:28:59.027046", "level": "INFO", "logger": "src.modules.reporter", "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_172859.csv", "module": "reporter", "function": "_save_csv_report", "line": 110}
{"timestamp": "2025-02-08T17:28:59.027150", "level": "INFO", "logger": "src.modules.reporter", "message": "Report generation completed successfully", "module": "reporter", "function": "generate_report", "line": 175}
{"timestamp": "2025-02-08T17:28:59.027218", "level": "INFO", "logger": "__main__", "message": "Report generated successfully", "module": "main", "function": "run", "line": 73}
{"timestamp": "2025-02-08T17:28:59.028112", "level": "ERROR", "logger": "src.modules.notifier", "message": "Error sending notifications", "module": "notifier", "function": "send_notifications", "line": 239, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 220, in send_notifications\n    email_body = NotificationTemplate.generate_email_body(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 63, in generate_email_body\n    <strong>{finding[\"finding_description\"]}</strong><br>\n             ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'finding_description'\n"}
{"timestamp": "2025-02-08T17:28:59.028749", "level": "ERROR", "logger": "__main__", "message": "Error in main execution: 'finding_description'", "module": "main", "function": "run", "line": 87, "stack_trace": "Traceback (most recent call last):\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/main.py\", line 78, in run\n    await self.notifier.send_notifications(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 220, in send_notifications\n    email_body = NotificationTemplate.generate_email_body(report)\n  File \"/Users/erindrian/Downloads/cloud-security-auditor/src/modules/notifier.py\", line 63, in generate_email_body\n    <strong>{finding[\"finding_description\"]}</strong><br>\n             ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'finding_description'\n"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:21.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T17:56:21.f"}
{"timestamp": "2025-02-08T17:56:22.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T17:56:22.f"}
{"timestamp": "2025-02-08T17:56:22.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 173 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T17:56:22.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 252 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py", line 220, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 77 "taskName": "Task-4" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 86 "taskName": "Task-4" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 121 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_175623.csv" "module": "reporter" "function": "_save_csv_report" "line": 110 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_175623.csv" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 175 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:23.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T17:56:23.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:48.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T17:56:48.f"}
{"timestamp": "2025-02-08T17:56:49.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T17:56:49.f"}
{"timestamp": "2025-02-08T17:56:49.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T17:56:49.f"}
{"timestamp": "2025-02-08T17:56:49.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T17:56:49.f"}
{"timestamp": "2025-02-08T17:56:49.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 173 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T17:56:49.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 252 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Downloads/cloud-security-auditor/src/modules/scanner.py", line 220, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 77 "taskName": "Task-4" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 86 "taskName": "Task-4" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 121 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_175650.csv" "module": "reporter" "function": "_save_csv_report" "line": 110 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Downloads/cloud-security-auditor/reports/compliance_report_20250208_175650.csv" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 175 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T17:56:50.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T17:56:50.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:07.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T18:31:07.f"}
{"timestamp": "2025-02-08T18:31:08.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T18:31:08.f"}
{"timestamp": "2025-02-08T18:31:08.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 212 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T18:31:08.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 291 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 259, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 99 "taskName": "Task-4" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 108 "taskName": "Task-4" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 121 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_183109.csv" "module": "reporter" "function": "_save_csv_report" "line": 110 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_183109.csv" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 175 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:31:09.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T18:31:09.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:50.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 212 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T18:44:50.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 291 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 259, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 99 "taskName": "Task-4" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 108 "taskName": "Task-4" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 121 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_184451.csv" "module": "reporter" "function": "_save_csv_report" "line": 110 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_184451.csv" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 175 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:44:51.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T18:44:51.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:43.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 212 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T18:46:43.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 291 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 259, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 99 "taskName": "Task-4" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 108 "taskName": "Task-4" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 180 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_184645.csv" "module": "reporter" "function": "_save_csv_report" "line": 169 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_184645.csv" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 237 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:46:45.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T18:46:45.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:09.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T18:52:09.f"}
{"timestamp": "2025-02-08T18:52:10.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T18:52:10.f"}
{"timestamp": "2025-02-08T18:52:10.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 212 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T18:52:10.f"}
{"timestamp": "2025-02-08T18:52:11.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 291 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 259, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T18:52:11.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error running gcloud command: ERROR: (gcloud.compute.instances.list) There was a problem refreshing your current auth tokens: Reauthentication failed. cannot prompt during non-interactive execution.
Please run:

  $ gcloud auth login

to obtain new credentials.

If you have already logged in with a different account, run:

  $ gcloud config set account ACCOUNT

to select an already authenticated account to use.
" "module": "scanner" "function": "_scan_compute" "line": 352 "taskName": "Task-4" "message": "Error running gcloud command: ERROR: (gcloud.compute.instances.list) There was a problem refreshing your current auth tokens: Reauthentication failed. cannot prompt during non-interactive execution.
Please run:

  $ gcloud auth login

to obtain new credentials.

If you have already logged in with a different account, run:

  $ gcloud config set account ACCOUNT

to select an already authenticated account to use.
" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in compute scanning" "module": "scanner" "function": "_scan_compute" "line": 362 "taskName": "Task-4" "error": "Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1." "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 322, in _scan_compute
    result = subprocess.run(cmd, capture_output=True, text=True, check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/subprocess.py", line 579, in run
    raise CalledProcessError(retcode, process.args,
                             output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1.
" "message": "Error in compute scanning" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 99 "taskName": "Task-5" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 108 "taskName": "Task-5" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in compute scanning" "module": "scanner" "function": "scan" "line": 407 "taskName": "Task-1" "error": "Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1." "message": "Error in compute scanning" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 180 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_185213.csv" "module": "reporter" "function": "_save_csv_report" "line": 169 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_185213.csv" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 237 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:13.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T18:52:13.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "INFO" "logger": "__main__" "message": "Logging initialized successfully" "module": "main" "function": "_setup_logging" "line": 30 "taskName": "None" "message": "Logging initialized successfully" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "INFO" "logger": "__main__" "message": "GCP credentials initialized successfully" "module": "main" "function": "_setup_credentials" "line": 44 "taskName": "None" "message": "GCP credentials initialized successfully" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "asyncio" "message": "Using selector: KqueueSelector" "module": "selector_events" "function": "__init__" "line": 64 "taskName": "None" "message": "Using selector: KqueueSelector" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "INFO" "logger": "__main__" "message": "Starting Cloud Security Auditor" "module": "main" "function": "run" "line": 53 "taskName": "Task-1" "message": "Starting Cloud Security Auditor" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "urllib3.util.retry" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "module": "retry" "function": "from_int" "line": 286 "taskName": "Task-2" "message": "Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): oauth2.googleapis.com:443" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "module": "connectionpool" "function": "_new_conn" "line": 1049 "taskName": "Task-2" "message": "Starting new HTTPS connection (1): storage.googleapis.com:443" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "DEBUG" "logger": "urllib3.connectionpool" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "module": "connectionpool" "function": "_make_request" "line": 544 "taskName": "Task-2" "message": "https://storage.googleapis.com:443 "GET /storage/v1/b?maxResults=100&project=test-project-450103&projection=noAcl&prettyPrint=false HTTP/1.1" 200 794" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:51.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning batch of 1 storage buckets" "module": "scanner" "function": "_scan_storage" "line": 212 "taskName": "Task-2" "message": "Scanning batch of 1 storage buckets" "asctime": "2025-02-08T18:52:51.f"}
{"timestamp": "2025-02-08T18:52:52.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in IAM scanning" "module": "scanner" "function": "_scan_iam" "line": 291 "taskName": "Task-3" "error": "403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]" "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 259, in _scan_iam
    policy = self.resource_manager_client.get_iam_policy(request=request)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/cloud/resourcemanager_v3/services/projects/client.py", line 1927, in get_iam_policy
    response = rpc(
        request,
    ...<2 lines>...
        metadata=metadata,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
        target,
    ...<3 lines>...
        on_error=on_error,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
    ~~~~~~~~~~~~~~~~~~~^
        exc,
        ^^^^
    ...<6 lines>...
        timeout,
        ^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.PermissionDenied: 403 Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry. [reason: "SERVICE_DISABLED"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "cloudresourcemanager.googleapis.com"
}
metadata {
  key: "serviceTitle"
  value: "Cloud Resource Manager API"
}
metadata {
  key: "containerInfo"
  value: "379849595138"
}
metadata {
  key: "consumer"
  value: "projects/379849595138"
}
metadata {
  key: "activationUrl"
  value: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
, locale: "en-US"
message: "Cloud Resource Manager API has not been used in project 379849595138 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry."
, links {
  description: "Google developers console API activation"
  url: "https://console.developers.google.com/apis/api/cloudresourcemanager.googleapis.com/overview?project=379849595138"
}
]
" "message": "Error in IAM scanning" "asctime": "2025-02-08T18:52:52.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error running gcloud command: ERROR: (gcloud.compute.instances.list) There was a problem refreshing your current auth tokens: Reauthentication failed. cannot prompt during non-interactive execution.
Please run:

  $ gcloud auth login

to obtain new credentials.

If you have already logged in with a different account, run:

  $ gcloud config set account ACCOUNT

to select an already authenticated account to use.
" "module": "scanner" "function": "_scan_compute" "line": 354 "taskName": "Task-4" "message": "Error running gcloud command: ERROR: (gcloud.compute.instances.list) There was a problem refreshing your current auth tokens: Reauthentication failed. cannot prompt during non-interactive execution.
Please run:

  $ gcloud auth login

to obtain new credentials.

If you have already logged in with a different account, run:

  $ gcloud config set account ACCOUNT

to select an already authenticated account to use.
" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in compute scanning" "module": "scanner" "function": "_scan_compute" "line": 364 "taskName": "Task-4" "error": "Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1." "stack_trace": "Traceback (most recent call last):
  File "/Users/erindrian/Desktop/cloud-auditor/src/modules/scanner.py", line 322, in _scan_compute
    result = subprocess.run(cmd, capture_output=True, text=True, check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/subprocess.py", line 579, in run
    raise CalledProcessError(retcode, process.args,
                             output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1.
" "message": "Error in compute scanning" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "src.modules.scanner" "message": "Scanning bucket: misconfigured_public_bucket" "module": "scanner" "function": "_scan_storage_bucket" "line": 99 "taskName": "Task-5" "message": "Scanning bucket: misconfigured_public_bucket" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "WARNING" "logger": "src.modules.scanner" "message": "Bucket misconfigured_public_bucket is publicly accessible" "module": "scanner" "function": "_scan_storage_bucket" "line": 108 "taskName": "Task-5" "message": "Bucket misconfigured_public_bucket is publicly accessible" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "ERROR" "logger": "src.modules.scanner" "message": "Error in compute scanning" "module": "scanner" "function": "scan" "line": 409 "taskName": "Task-1" "error": "Command '['gcloud', 'compute', 'instances', 'list', '--format=json', '--project=test-project-450103']' returned non-zero exit status 1." "message": "Error in compute scanning" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "__main__" "message": "Scanning completed. Found 1 findings." "module": "main" "function": "run" "line": 58 "taskName": "Task-1" "message": "Scanning completed. Found 1 findings." "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Generating security audit report" "module": "reporter" "function": "generate_report" "line": 180 "taskName": "Task-1" "message": "Generating security audit report" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "src.modules.reporter" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_185253.csv" "module": "reporter" "function": "_save_csv_report" "line": 169 "taskName": "Task-1" "message": "CSV report saved successfully to /Users/erindrian/Desktop/cloud-auditor/reports/compliance_report_20250208_185253.csv" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "src.modules.reporter" "message": "Report generation completed successfully" "module": "reporter" "function": "generate_report" "line": 237 "taskName": "Task-1" "message": "Report generation completed successfully" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "__main__" "message": "Report generated successfully" "module": "main" "function": "run" "line": 64 "taskName": "Task-1" "message": "Report generated successfully" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "src.modules.notifier" "message": "No notification channels enabled" "module": "notifier" "function": "send_notifications" "line": 236 "taskName": "Task-1" "message": "No notification channels enabled" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "__main__" "message": "Notifications sent successfully" "module": "main" "function": "run" "line": 70 "taskName": "Task-1" "message": "Notifications sent successfully" "asctime": "2025-02-08T18:52:53.f"}
{"timestamp": "2025-02-08T18:52:53.f" "level": "INFO" "logger": "__main__" "message": "Cloud Security Auditor completed successfully" "module": "main" "function": "run" "line": 73 "taskName": "Task-1" "message": "Cloud Security Auditor completed successfully" "asctime": "2025-02-08T18:52:53.f"}
